<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Kata Vanilla</title>
    <script src="core.js"></script>
    <script src="vanilla.js"></script>
</head>

<body>
    <script>
        class BaseElement extends HTMLElement {
            constructor() {
                super();
                this._root = this.attachShadow({ mode: 'open' });
                this.props = {};
            }
            connectedCallback() {
                this.__render();
            }
            __render() {
                // const tmpl = $("#x-layout-tmpl")[0].content;
                // this.appendChild(tmpl.cloneNode(true));
                // this._root.appendChild(tmpl.cloneNode(true));
                const node = this.render(this.props);
                if (node) {
                    this._root.appendChild(node);
                }
            }
        }
        customElements.define('x-counter', class extends BaseElement {
            static get observedAttributes() {
                return ["count"];
            }

            attributeChangedCallback(attr, oldValue, rawValue) {
                let value = rawValue;
                switch (attr) {
                    case "count":
                        value = Number(rawValue);
                        break;
                }
                this.props[attr] = value;
            }

            render(props) {
                return H.button({
                    onClick(e) {
                        props.count += 1;
                        $("[data-id=count]", this)[0].innerText = props.count;
                    }
                },
                    `Log ${props.count}! `,
                    H.span({ "data-id": "count" }, props.count),
                    // `Log `, () => props.count, `!`,
                    // H.span(null, () => props.count),
                );
            }
        });

    </script>

    <x-counter count="0"></x-counter>
    <!--
    <div slot="sidebar">SIDEBAR</div>
    <div slot="main">MAIN</div>
    <template id="x-layout-tmpl">
        <div>
            <slot name="sidebar"></slot>
        </div>
        <slot name="main"></slot>
    </template>
    -->
</body>

</html>